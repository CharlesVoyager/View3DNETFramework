<Window x:Class="View3D.view.wpf.STLComposer"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             Height="540" 
             Width="400"
             Title="STLCompoer"
             ResizeMode="NoResize" Closing="Window_Closing">

    <Window.Resources>
        <!-- Validation error style for TextBox -->
        <Style x:Key="ValidatedTextBox" TargetType="TextBox">
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip"
                            Value="{Binding RelativeSource={RelativeSource Self},
                                           Path=(Validation.Errors)[0].ErrorContent}"/>
                    <Setter Property="BorderBrush" Value="Red"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- Root scroll container mirroring WinForms panelControls AutoScroll -->
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled"
                  x:Name="panelControls">
        <StackPanel Orientation="Vertical">

            <!-- ═══════════════════════════════════════════
                 listObjects  –  replaces WinForms ListView
                 ═══════════════════════════════════════════ -->
            <ListView x:Name="listObjects"
                      Height="181"
                      SelectionMode="Extended"
                      SelectionChanged="listObjects_SelectionChanged"
                      KeyDown="listObjects_KeyDown"
                      SizeChanged="listObjects_SizeChanged">
                <ListView.View>
                    <GridView AllowsColumnReorder="False">
                        <!-- Name column – width managed in code-behind -->
                        <GridViewColumn x:Name="columnName"
                                        Header="Name"
                                        Width="150"
                                        DisplayMemberBinding="{Binding Name}"/>

                        <!-- Mesh column – custom cell template -->
                        <GridViewColumn x:Name="columnMesh"
                                        Header="Mesh"
                                        Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Image x:Name="imgMesh"
                                           Width="16" Height="16"
                                           HorizontalAlignment="Center"
                                           Source="{Binding MeshStatusImage}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!-- Collision column -->
                        <GridViewColumn x:Name="columnCollision"
                                        Header="Collision"
                                        Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Image Width="16" Height="16"
                                           HorizontalAlignment="Center"
                                           Source="{Binding CollisionStatusImage}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!-- Delete column -->
                        <GridViewColumn x:Name="columnDelete"
                                        Header=""
                                        Width="26">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Width="16" Height="16"
                                            Padding="0"
                                            BorderThickness="0"
                                            Background="Transparent"
                                            Tag="{Binding Model}"
                                            Click="buttonRemoveObject_Click"
                                            ToolTip="Remove">
                                        <!-- Trash icon –  replace Source with your resource URI -->
                                        <Image Source="/View3D;component/Resources/trash16.png"
                                               Width="14" Height="14"/>
                                    </Button>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>

            <!-- ═══════════════════════════════════════════
                 panel1  –  Trans / Scale / Rotate controls
                 ═══════════════════════════════════════════ -->
            <Border x:Name="panel1" Height="107" Padding="4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>   <!-- row labels -->
                        <ColumnDefinition Width="Auto"/> <!-- X label -->
                        <ColumnDefinition Width="68"/>   <!-- X value -->
                        <ColumnDefinition Width="Auto"/> <!-- Y label -->
                        <ColumnDefinition Width="68"/>   <!-- Y value -->
                        <ColumnDefinition Width="Auto"/> <!-- Z label -->
                        <ColumnDefinition Width="68"/>   <!-- Z value -->
                        <ColumnDefinition Width="*"/>    <!-- LockAspect -->
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="32"/>
                        <RowDefinition Height="11"/> <!-- axis header row -->
                    </Grid.RowDefinitions>

                    <!-- Axis header labels (row 3) -->
                    <TextBlock Grid.Row="3" Grid.Column="2" Text="X"
                               HorizontalAlignment="Center" FontWeight="Bold" FontSize="10"/>
                    <TextBlock Grid.Row="3" Grid.Column="4" Text="Y"
                               HorizontalAlignment="Center" FontWeight="Bold" FontSize="10"/>
                    <TextBlock Grid.Row="3" Grid.Column="6" Text="Z"
                               HorizontalAlignment="Center" FontWeight="Bold" FontSize="10"/>

                    <!-- Row labels -->
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Trans"
                               VerticalAlignment="Center" Margin="4,0"/>
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Scale"
                               VerticalAlignment="Center" Margin="4,0"/>
                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Rotate"
                               VerticalAlignment="Center" Margin="4,0"/>

                    <!-- Trans -->
                    <TextBox x:Name="textTransX" Grid.Row="0" Grid.Column="2"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textTransX_TextChanged"/>
                    <TextBox x:Name="textTransY" Grid.Row="0" Grid.Column="4"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textTransY_TextChanged"/>
                    <TextBox x:Name="textTransZ" Grid.Row="0" Grid.Column="6"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textTransZ_TextChanged"/>

                    <!-- Scale -->
                    <TextBox x:Name="textScaleX" Grid.Row="1" Grid.Column="2"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textScaleX_TextChanged"/>
                    <TextBox x:Name="textScaleY" Grid.Row="1" Grid.Column="4"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textScaleY_TextChanged"/>
                    <TextBox x:Name="textScaleZ" Grid.Row="1" Grid.Column="6"
                             Margin="4,4" VerticalAlignment="Center" Text="1"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textScaleZ_TextChanged"/>

                    <!-- Lock aspect button (column 7, rows 1) -->
                    <ToggleButton x:Name="buttonLockAspect"
                                  Grid.Row="1" Grid.Column="7"
                                  Width="57" Height="28"
                                  Margin="4" VerticalAlignment="Center"
                                  ToolTip="Lock aspect ratio"
                                  Click="buttonLockAspect_Click">
                        <!-- Replace with your lock/unlock image resource -->
                        <Image x:Name="imgLockAspect"
                               Source="/View3D;component/Resources/unlock16.png"
                               Width="16" Height="16"/>
                    </ToggleButton>

                    <!-- Rotate -->
                    <TextBox x:Name="textRotX" Grid.Row="2" Grid.Column="2"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textRotX_TextChanged"/>
                    <TextBox x:Name="textRotY" Grid.Row="2" Grid.Column="4"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textRotY_TextChanged"/>
                    <TextBox x:Name="textRotZ" Grid.Row="2" Grid.Column="6"
                             Margin="4,4" VerticalAlignment="Center"
                             Style="{StaticResource ValidatedTextBox}"
                             TextChanged="textRotZ_TextChanged"/>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════
                 panelAnalysis  –  Object Analysis GroupBox
                 ═══════════════════════════════════════════ -->
            <Border x:Name="panelAnalysis" Height="208" Visibility="Visible">
                <GroupBox Header="Object Analysis" Margin="4,8" Background="White"
                          x:Name="groupBoxObjectAnalysis">
                    <Grid Margin="4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="65*"/>
                            <ColumnDefinition Width="35*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                            <RowDefinition Height="24"/>
                        </Grid.RowDefinitions>

                        <!-- Row 0 – Intersecting triangles -->
                        <TextBlock Grid.Row="0" Grid.Column="0"
                                   Text="Intersecting triangles:"
                                   VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelIntersectingTriangles"
                                   Grid.Row="0" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 1 – Loop edges -->
                        <TextBlock Grid.Row="1" Grid.Column="0"
                                   Text="Loop edges:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelLoopEdges"
                                   Grid.Row="1" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 2 – Highly connected -->
                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="Highly connected edges:"
                                   VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelHighConnected"
                                   Grid.Row="2" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 3 – Vertices -->
                        <TextBlock Grid.Row="3" Grid.Column="0"
                                   Text="Vertices:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelVertices"
                                   Grid.Row="3" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 4 – Edges -->
                        <TextBlock Grid.Row="4" Grid.Column="0"
                                   Text="Edges:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelEdges"
                                   Grid.Row="4" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 5 – Faces -->
                        <TextBlock Grid.Row="5" Grid.Column="0"
                                   Text="Faces:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelFaces"
                                   Grid.Row="5" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>

                        <!-- Row 6 – Shells -->
                        <TextBlock Grid.Row="6" Grid.Column="0"
                                   Text="Shells:" VerticalAlignment="Center"/>
                        <TextBlock x:Name="labelShells"
                                   Grid.Row="6" Grid.Column="1"
                                   Text="0" VerticalAlignment="Center"/>
                    </Grid>
                </GroupBox>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Window>
